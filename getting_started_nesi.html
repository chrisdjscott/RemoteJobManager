
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Getting started on NeSI &#8212; RemoteJobManager 0.6.5 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Getting started (manual steps)" href="getting_started_manual.html" />
    <link rel="prev" title="Welcome to RemoteJobManager’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="getting-started-on-nesi">
<h1>Getting started on NeSI<a class="headerlink" href="#getting-started-on-nesi" title="Permalink to this heading">¶</a></h1>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#install-rjm" id="id1">Install RJM</a></p></li>
<li><p><a class="reference internal" href="#prerequisites-for-running-the-setup-script" id="id2">Prerequisites for running the setup script</a></p>
<ul>
<li><p><a class="reference internal" href="#linking-globus-and-nesi-accounts" id="id3">Linking Globus and NeSI accounts</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#run-the-nesi-setup-script-once" id="id4">Run the NeSI setup script (once)</a></p>
<ul>
<li><p><a class="reference internal" href="#transferring-config-to-a-different-machine" id="id5">Transferring config to a different machine</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#authenticate-rjm" id="id6">Authenticate RJM</a></p></li>
<li><p><a class="reference internal" href="#run-a-simple-test" id="id7">Run a simple test</a></p>
<ul>
<li><p><a class="reference internal" href="#health-check-script" id="id8">Health check script</a></p></li>
<li><p><a class="reference internal" href="#example-simulation" id="id9">Example simulation</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="install-rjm">
<h2>Install RJM<a class="headerlink" href="#install-rjm" title="Permalink to this heading">¶</a></h2>
<p>On Windows you could download the executables from the latest release
on the <a class="reference external" href="https://github.com/chrisdjscott/RemoteJobManager/releases">GitHub repository</a>.</p>
<p>Otherwise, install the <em>rjm</em> python package, for example using a virtual
environment and installing the <em>main</em> branch from the git repo:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python -m venv venv
<span class="nb">source</span> venv/bin/activate
python -m pip install git+https://github.com/chrisdjscott/RemoteJobManager
</pre></div>
</div>
</section>
<section id="prerequisites-for-running-the-setup-script">
<h2>Prerequisites for running the setup script<a class="headerlink" href="#prerequisites-for-running-the-setup-script" title="Permalink to this heading">¶</a></h2>
<p>In order to proceed with the setup you will need the following:</p>
<ul class="simple">
<li><p>NeSI credentials (username, first and second factor passwords)</p></li>
<li><p>NeSI project code that you belong to (e.g. uoa00106)</p></li>
<li><p>Globus account (<a class="reference external" href="https://app.globus.org/">https://app.globus.org/</a>)</p>
<ul>
<li><p>You can usually sign up with your institutional credentials (e.g.
University of Auckland) for convenience but it is not essential</p></li>
</ul>
</li>
</ul>
<p><strong>Note:</strong> during the setup you may be asked to authenticate multiple times and
in some cases a browser window may be opened automatically for you to
authenticate in and in other cases you may need to copy a link to a browser
manually and authenticate there. Please follow the instructions that show up
when running the setup script.</p>
<section id="linking-globus-and-nesi-accounts">
<h3>Linking Globus and NeSI accounts<a class="headerlink" href="#linking-globus-and-nesi-accounts" title="Permalink to this heading">¶</a></h3>
<p>You may be asked for a linked identity with the <em>NeSI Wellington OIDC Server</em>.
If you already have a linked identity it should appear in the list like
<em>&lt;username&gt;&#64;wlg-dtn-oidc.nesi.org.nz</em> (where <em>&lt;username&gt;</em> is your NeSI username).
Otherwise, you can follow the instructions to <em>Link an identity from NeSI
Wellington OIDC Server</em>.</p>
</section>
</section>
<section id="run-the-nesi-setup-script-once">
<h2>Run the NeSI setup script (once)<a class="headerlink" href="#run-the-nesi-setup-script-once" title="Permalink to this heading">¶</a></h2>
<p>The NeSI setup script (either <code class="code docutils literal notranslate"><span class="pre">rjm_nesi_setup.exe</span></code> or
<code class="code docutils literal notranslate"><span class="pre">rjm_nesi_setup</span></code>) will do the following:</p>
<ul class="simple">
<li><p>configure and start a “funcX endpoint” on NeSI, which RJM will use to execute
commands on NeSI</p></li>
<li><p>setup a periodic task (via scrontab) to check that the funcX endpoint is
running and restart it if it has stopped</p></li>
<li><p>create a “Globus Guest Collection” in your NeSI nobackup directory, which will
be used to transfer files to and from NeSI</p></li>
</ul>
<p>When you run the setup script you will need to input values and authenticate
multiple times, which can’t be avoided at this time unfortunately. In some cases
a browser window will open where you will need to do the authentication, in other
cases you will enter details directly at the terminal. You will
need to authenticate with NeSI (first and sector factor) and with Globus, which
can usually be done using your institutions credentials, e.g. University of
Auckland.</p>
<p>Running the script with the <code class="code docutils literal notranslate"><span class="pre">--config</span></code> option will write the settings to
the RJM config file:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rjm_nesi_setup.exe --config
</pre></div>
</div>
<p><strong>Note:</strong> you only need to run this script once. You can reuse the config created
in this step on multiple machines.</p>
<section id="transferring-config-to-a-different-machine">
<h3>Transferring config to a different machine<a class="headerlink" href="#transferring-config-to-a-different-machine" title="Permalink to this heading">¶</a></h3>
<p>Export the config on the machine that you generated it on:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rjm_configure.exe --export-config myrjmconfig.ini
</pre></div>
</div>
<p>This should write a file called <em>myrjmconfig.ini</em> into your current directory.
Copy this file to another machine and install it by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rjm_configure.exe --import-config myrjmconfig.ini
</pre></div>
</div>
<p>You will still need to redo the authentication step below on the new machine.</p>
</section>
</section>
<section id="authenticate-rjm">
<h2>Authenticate RJM<a class="headerlink" href="#authenticate-rjm" title="Permalink to this heading">¶</a></h2>
<p>Run the <code class="code docutils literal notranslate"><span class="pre">rjm_authenticate.exe</span></code> executable to authenticate using the
configuration created in the previous step:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rjm_authenticate.exe
</pre></div>
</div>
<p>This will open a browser window and ask you to authenticate with Globus.</p>
<p>You should only need to do this step once per machine because your credentials
will be cached and reused.</p>
</section>
<section id="run-a-simple-test">
<h2>Run a simple test<a class="headerlink" href="#run-a-simple-test" title="Permalink to this heading">¶</a></h2>
<section id="health-check-script">
<h3>Health check script<a class="headerlink" href="#health-check-script" title="Permalink to this heading">¶</a></h3>
<p>The health check script tests that basic functionality is working by uploading
a file to NeSI and executing a simple command.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>rjm_health_check.exe
</pre></div>
</div>
<p>If should exit successfully with no errors if things are working.</p>
</section>
<section id="example-simulation">
<h3>Example simulation<a class="headerlink" href="#example-simulation" title="Permalink to this heading">¶</a></h3>
<p>Clone the repository and run the example simulation using the steps below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git clone https://github.com/chrisdjscott/RemoteJobManager.git
<span class="nb">cd</span> RemoteJobManager/examples/nonmem
rjm_batch_submit.exe -f localdirs.txt -ll info
rjm_batch_wait.exe -f localdirs.txt -ll info
</pre></div>
</div>
<p><strong>Note:</strong> for the above to work you need to either make sure the RJM executables
are in your PATH or provide the full path to them. Remove the “.exe” suffix if
you are using the pip installed python package rather than the Windows
executables.</p>
<p>If the above worked there should be a file created at <em>files/output.zip</em>.</p>
<p>You should also notice the file <em>files/remote_job.json</em>. This file records the
progress of the remote job. If you try to run a simulation again in the same
directory, RJM should detect that it already ran before and won’t repeat the
same steps again. You can override this behaviour by passing the <code class="code docutils literal notranslate"><span class="pre">--force</span></code>
option to <code class="code docutils literal notranslate"><span class="pre">rjm_batch_submit.exe</span></code> or delete the <em>remote_job.json</em> file.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">RemoteJobManager</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting started on NeSI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#install-rjm">Install RJM</a></li>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites-for-running-the-setup-script">Prerequisites for running the setup script</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-the-nesi-setup-script-once">Run the NeSI setup script (once)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#authenticate-rjm">Authenticate RJM</a></li>
<li class="toctree-l2"><a class="reference internal" href="#run-a-simple-test">Run a simple test</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="getting_started_manual.html">Getting started (manual steps)</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_rjm.html">Using RJM</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to RemoteJobManager’s documentation!</a></li>
      <li>Next: <a href="getting_started_manual.html" title="next chapter">Getting started (manual steps)</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, The University of Auckland.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/getting_started_nesi.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>